---
alwaysApply: true
---
# Project Index - Always Consult Main.md

## Critical Rule for AI Agents

**ALWAYS read `Main.md` at the start of any task** to understand:
- Project architecture
- System organization  
- File locations
- Key documentation references

## Quick Context

This is a Unity 2D Arena Survivor game with:
- **Deterministic client-server architecture**
- **MCP server integration** for AI automation
- **Event-driven simulation** at 30 tps
- **Clean assembly separation** (Shared vs Client)

## Main.md Location

**Path**: `/Users/vinhtrinh/code/mcptest/Main.md`

Or from workspace root: `./Main.md`

## When to Read Main.md

- ✅ Starting any new task
- ✅ Need to understand architecture
- ✅ Looking for specific system
- ✅ Finding documentation
- ✅ Understanding file structure
- ✅ Before making architectural changes

## What's in Main.md

1. **Architecture Overview** - Client-server model
2. **MCP Server System** - Tool organization
3. **Game Systems** - Simulation & visualization
4. **Project Structure** - Complete file tree
5. **Configuration** - JSON config files
6. **Scenes** - Unity scenes explained
7. **Quick Reference** - Common tasks
8. **Recent Changes** - Cleanup summary

## Other Rules

This project has additional rules in `.cursor/rules/`:
- `unity-mcp-core.mdc` - MCP server usage
- `unity-ui-best-practices.mdc` - UI creation
- `main-index.mdc` - This file

## Workflow

```
1. Read Main.md (project overview)
2. Check relevant system section
3. Follow documentation links as needed
4. Use MCP tools (port 8765)
5. Test with Unity Editor
```

## Critical: Unity & MCP Restart Protocol

**ALWAYS ask the user to restart Unity and MCP before proceeding with any task that involves:**
- Unity Editor operations
- MCP tool usage
- Script compilation
- Scene modifications
- Prefab changes
- Any Unity-related work

**NEVER automatically proceed with Unity/MCP operations without explicit confirmation that both are restarted and ready.**

**Workflow**:
1. When starting a Unity-related task, **FIRST** ask: "Please restart Unity Editor and the MCP server, then confirm when ready."
2. **WAIT** for user confirmation before proceeding
3. Only then begin using MCP tools or making changes

**Why**: Unity Editor and MCP server can get into inconsistent states. Restarting ensures a clean state before operations.

## Key Principles

- **Deterministic**: Fixed-point math, no floating point
- **Event-driven**: Emit events for state changes
- **Command-driven**: Player inputs are commands
- **Separated**: Simulation (Shared) independent of rendering (Client)
- **Clean**: No circular dependencies

## Troubleshooting Log Prefixes

**ALWAYS use unique prefixes for troubleshooting logs** to make them easy to filter and identify.

**Format**: `[prefix] Message content`

**Examples**:
- `[projmiss]` - Projectile collision/miss debugging
- `[animtest]` - Animation system debugging
- `[combat]` - Combat system debugging
- `[spawn]` - Entity spawning debugging
- `[movement]` - Movement system debugging

**Rules**:
1. Use a **unique, descriptive prefix** for each system/feature
2. Use **square brackets** `[prefix]` format
3. Keep prefixes **short** (3-10 characters)
4. Use **lowercase** with no spaces
5. Document the prefix in code comments if it's used extensively

**Why**: Makes it easy to filter logs in Unity Console or log files to focus on specific systems.

---

**Remember**: Main.md is your map. Start there!
